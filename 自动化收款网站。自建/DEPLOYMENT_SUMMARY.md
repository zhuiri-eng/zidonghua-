# æ”¯ä»˜å›è°ƒç³»ç»Ÿéƒ¨ç½²æ€»ç»“

## ğŸ‰ é¡¹ç›®å·²å®Œæˆï¼

æ‚¨çš„æ”¯ä»˜å›è°ƒç³»ç»Ÿå·²ç»å‡†å¤‡å°±ç»ªï¼ŒåŒ…å«ä»¥ä¸‹å®Œæ•´åŠŸèƒ½ï¼š

### ğŸ“ é¡¹ç›®ç»“æ„
```
payment_callback/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ database.php          # æ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ database.example.php  # é…ç½®ç¤ºä¾‹
â”œâ”€â”€ includes/
â”‚   â”œâ”€â”€ functions.php         # æ ¸å¿ƒå‡½æ•°åº“
â”‚   â””â”€â”€ auth.php             # è®¤è¯é€»è¾‘
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ css/style.css        # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ js/main.js           # JavaScriptæ–‡ä»¶
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ header.php           # é¡µé¢å¤´éƒ¨
â”‚   â”œâ”€â”€ footer.php           # é¡µé¢åº•éƒ¨
â”‚   â”œâ”€â”€ success.php          # æˆåŠŸé¡µé¢
â”‚   â””â”€â”€ failure.php          # å¤±è´¥é¡µé¢
â”œâ”€â”€ database/
â”‚   â””â”€â”€ init.sql             # æ•°æ®åº“åˆå§‹åŒ–
â”œâ”€â”€ callback.php             # åŒæ­¥å›è°ƒå¤„ç†
â”œâ”€â”€ notify.php               # å¼‚æ­¥é€šçŸ¥å¤„ç†
â”œâ”€â”€ query_order.php          # è®¢å•æŸ¥è¯¢API
â”œâ”€â”€ index.php                # ä¸»é¡µé¢
â”œâ”€â”€ .htaccess                # Apacheé…ç½®
â”œâ”€â”€ netlify.toml             # Netlifyé…ç½®
â””â”€â”€ DEPLOY.md                # éƒ¨ç½²æŒ‡å—
```

### ğŸš€ æ ¸å¿ƒåŠŸèƒ½

1. **è®¢å•ç®¡ç†**
   - åˆ›å»ºè®¢å•
   - æŸ¥è¯¢è®¢å•çŠ¶æ€
   - è®¢å•ç»Ÿè®¡

2. **æ”¯ä»˜å¤„ç†**
   - åŒæ­¥å›è°ƒå¤„ç†
   - å¼‚æ­¥é€šçŸ¥å¤„ç†
   - ç­¾åéªŒè¯

3. **å®‰å…¨æœºåˆ¶**
   - APIå¯†é’¥éªŒè¯
   - IPç™½åå•
   - è¯·æ±‚ç­¾åéªŒè¯
   - SQLæ³¨å…¥é˜²æŠ¤

4. **ç”¨æˆ·ç•Œé¢**
   - ç°ä»£åŒ–å“åº”å¼è®¾è®¡
   - æ”¯ä»˜æˆåŠŸ/å¤±è´¥é¡µé¢
   - è®¢å•æŸ¥è¯¢ç•Œé¢

### ğŸ“Š æ•°æ®åº“è®¾è®¡

- **ordersè¡¨**: è®¢å•ä¿¡æ¯å­˜å‚¨
- **payment_logsè¡¨**: æ”¯ä»˜æ—¥å¿—è®°å½•
- å®Œæ•´çš„ç´¢å¼•ä¼˜åŒ–
- UTF8MB4å­—ç¬¦é›†æ”¯æŒ

### ğŸ”§ æŠ€æœ¯æ ˆ

- **åç«¯**: PHP 8.1+
- **æ•°æ®åº“**: MySQL 8.0+
- **å‰ç«¯**: HTML5, CSS3, JavaScript
- **æœåŠ¡å™¨**: Apache/Nginx
- **éƒ¨ç½²**: Netlify

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. GitHubæ¨é€
```bash
# è¿è¡Œéƒ¨ç½²è„šæœ¬
deploy.bat

# æˆ–æ‰‹åŠ¨æ‰§è¡Œ
git add .
git commit -m "Initial commit: æ”¯ä»˜å›è°ƒç³»ç»Ÿ"
git push -u origin master
```

### 2. Netlifyéƒ¨ç½²

1. è®¿é—® [Netlify](https://netlify.com)
2. ç‚¹å‡» "New site from Git"
3. é€‰æ‹© GitHub å¹¶æˆæƒ
4. é€‰æ‹©ä»“åº“ `zhuiri-eng/zidonghua-`
5. é…ç½®éƒ¨ç½²è®¾ç½®ï¼š
   - Build command: ç•™ç©º
   - Publish directory: `.`
6. ç‚¹å‡» "Deploy site"

### 3. ç¯å¢ƒé…ç½®

åœ¨Netlifyçš„ç¯å¢ƒå˜é‡ä¸­è®¾ç½®ï¼š
```
DB_HOST=your_database_host
DB_USERNAME=your_username
DB_PASSWORD=your_password
DB_NAME=payment_system
PAYMENT_SECRET=your_payment_secret
API_KEY=your_api_key
```

### 4. æ•°æ®åº“è®¾ç½®

1. åˆ›å»ºMySQLæ•°æ®åº“
2. å¯¼å…¥ `database/init.sql`
3. ç¡®ä¿æ•°æ®åº“å¯ä»Netlifyè®¿é—®

## ğŸ” å®‰å…¨é…ç½®

- æ•æ„Ÿé…ç½®æ–‡ä»¶å·²æ’é™¤åœ¨ç‰ˆæœ¬æ§åˆ¶å¤–
- ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†å¯†é’¥
- å®ç°äº†å®Œæ•´çš„è¯·æ±‚éªŒè¯
- æ”¯æŒHTTPSå¼ºåˆ¶é‡å®šå‘

## ğŸ“ ä½¿ç”¨è¯´æ˜

### APIæ¥å£

1. **åˆ›å»ºè®¢å•**: POST `/index.php`
2. **æŸ¥è¯¢è®¢å•**: GET `/query_order.php?order_id=xxx`
3. **åŒæ­¥å›è°ƒ**: POST `/callback.php`
4. **å¼‚æ­¥é€šçŸ¥**: POST `/notify.php`

### æµ‹è¯•ç³»ç»Ÿ

è¿è¡Œ `test_system.php` å¯ä»¥æµ‹è¯•æ‰€æœ‰åŠŸèƒ½ã€‚

## ğŸ¯ ä¸‹ä¸€æ­¥

1. æ¨é€ä»£ç åˆ°GitHub
2. åœ¨Netlifyä¸Šéƒ¨ç½²
3. é…ç½®æ•°æ®åº“è¿æ¥
4. è®¾ç½®æ”¯ä»˜å¹³å°å›è°ƒURL
5. æµ‹è¯•å®Œæ•´æ”¯ä»˜æµç¨‹

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- `README.md` - è¯¦ç»†è¯´æ˜æ–‡æ¡£
- `INSTALL.md` - å®‰è£…æŒ‡å—
- `DEPLOY.md` - éƒ¨ç½²æŒ‡å—

---

**ç¥æ‚¨éƒ¨ç½²é¡ºåˆ©ï¼** ğŸ‰
